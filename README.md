# ExploreWithMe — микросервисное приложение

**ExploreWithMe** — это микросервисное веб-приложение для организации и поиска событий.  
Пользователи могут создавать события, подавать заявки на участие, оставлять комментарии и просматривать подборки мероприятий.

Проект реализован в виде набора независимых микросервисов с централизованной конфигурацией, сервис-дискавери и API Gateway.

---

## ?? Архитектура проекта

Проект построен по микросервисной архитектуре и состоит из следующих компонентов:

- **Gateway Server** — единая точка входа (API Gateway)
- **Discovery Server (Eureka)** — регистрация и обнаружение сервисов
- **Config Server** — централизованная конфигурация
- **Business-сервисы** (event, user, request, comment)
- **Stats Server** — сбор статистики просмотров
- **PostgreSQL** — отдельные схемы БД для сервисов

Взаимодействие между сервисами реализовано через **Spring Cloud OpenFeign**  
Для устойчивости используются **Resilience4j (Retry, CircuitBreaker, Fallback)**

---

## ?? Состав микросервисов

### Event Service

Микросервис **event-service** управляет событиями пользователей.

#### Основные функции
- Создание и редактирование событий
- Публикация и отклонение событий администраторами
- Получение событий с фильтрацией и пагинацией
- Подсчёт подтверждённых заявок
- Проверка прав инициатора

#### Взаимодействие с сервисами

| Сервис | Назначение | Протокол |
|------|-----------|----------|
| user-service | данные пользователей | Feign |
| request-service | заявки на участие | Feign |
| comment-service | комментарии | Feign |
| gateway | входящие HTTP-запросы | REST |

---

### User Service

Микросервис **user-service** управляет пользователями проекта.

#### Основные функции
- Создание и удаление пользователей
- Получение информации о пользователях
- Валидация пользователей для других сервисов
- Контроль прав доступа

#### Взаимодействие

| Сервис | Назначение | Протокол |
|------|-----------|----------|
| event-service | события пользователя | Feign |
| request-service | заявки | Feign |
| comment-service | комментарии | Feign |
| gateway | HTTP-запросы | REST |

---

### Request Service

Микросервис **request-service** управляет заявками на участие в событиях.

#### Основные функции
- Создание заявки на участие
- Получение заявок пользователя
- Получение заявок по событию
- Подтверждение / отклонение заявок
- Контроль лимита участников
- Проверка состояния события

#### Взаимодействие

| Сервис | Назначение | Протокол |
|------|-----------|----------|
| user-service | проверка пользователя | Feign |
| event-service | проверка события | Feign |
| gateway | HTTP-запросы | REST |

---

### Comment Service

Микросервис **comment-service** управляет комментариями к событиям.

#### Основные функции
- Добавление комментариев
- Редактирование и удаление комментариев
- Получение комментариев

#### Взаимодействие

| Сервис | Назначение | Протокол |
|------|-----------|----------|
| user-service | проверка пользователя | Feign |
| event-service | проверка события | Feign |
| gateway | HTTP-запросы | REST |

---

### Stats Server

Микросервис **stats-server** отвечает за сбор и предоставление статистики просмотров.

#### Основные функции
- Сохранение информации о просмотрах
- Получение агрегированной статистики

Используется отдельная база данных `statsdb`.

---

### Interaction API

Модуль **interaction-api** содержит:
- Общие DTO
- Контракты REST API

Используется всеми микросервисами как библиотека.

---

## ?? Внешний API

Внешний API проекта полностью описан в формате **OpenAPI (Swagger)**.

### ?? Спецификация API

**Main API (ExploreWithMe):**  
https://raw.githubusercontent.com/yandex-praktikum/java-explore-with-me/main/ewm-main-service-spec.json

Спецификация включает:
- публичные, приватные и административные эндпоинты
- схемы DTO
- параметры фильтрации и пагинации
- возможные коды ответов и ошибки

---

## ?? Устойчивость и отказоустойчивость

Для межсервисного взаимодействия используются:

- **Feign Clients**
- **Resilience4j**
  - Retry
  - CircuitBreaker
  - Fallback-классы